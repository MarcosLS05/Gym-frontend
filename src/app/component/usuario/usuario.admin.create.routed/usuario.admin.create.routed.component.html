<div class="container mt-5 d-flex align-items-center justify-content-center">
    <div class="card shadow-lg p-4" style="max-width: 600px; width: 100%;">
      <div class="card-body">
        <h2 class="text-center mb-4">
          <i class="bi bi-plus-square"></i>
          Creación de Usuario
          <i class="bi bi-person-circle"></i>
        </h2>
  
        <form [formGroup]="oUsuarioForm!" (ngSubmit)="onSubmit()" novalidate>
          <!-- Nombre -->
          <div class="mb-3">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Nombre</mat-label>
              <input matInput formControlName="nombre" required />
              <mat-hint align="start">De 3 a 50 caracteres</mat-hint>
              @if (oUsuarioForm?.get('nombre')?.hasError('required')) {
                <mat-error>El campo nombre es obligatorio</mat-error>
              }
              @if (oUsuarioForm?.get('nombre')?.hasError('minlength')) {
                <mat-error>El nombre debe ser más largo</mat-error>
              }
              @if (oUsuarioForm?.get('nombre')?.hasError('maxlength')) {
                <mat-error>El nombre debe ser más corto</mat-error>
              }
            </mat-form-field>
          </div>
  
          <!-- Primer Apellido -->
          <div class="mb-3">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Primer Apellido</mat-label>
              <input matInput formControlName="apellido1" required />
              <mat-hint align="start">De 3 a 50 caracteres</mat-hint>
              @if (oUsuarioForm?.get('apellido1')?.hasError('required')) {
                <mat-error>Debes introducir un primer apellido</mat-error>
              }
              @if (oUsuarioForm?.get('apellido1')?.hasError('minlength')) {
                <mat-error>Debes introducir un apellido más largo</mat-error>
              }
              @if (oUsuarioForm?.get('apellido1')?.hasError('maxlength')) {
                <mat-error>Debes introducir un apellido más corto</mat-error>
              }
            </mat-form-field>
          </div>
  
          <!-- Segundo Apellido -->
          <div class="mb-3">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Segundo Apellido</mat-label>
              <input matInput formControlName="apellido2" />
            </mat-form-field>
          </div>
  
          <!-- Email -->
          <div class="mb-3">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Email</mat-label>
              <input matInput formControlName="email" required />
              <mat-hint align="start">Formato email</mat-hint>
              @if (oUsuarioForm?.get('email')?.hasError('required')) {
                <mat-error>Debes introducir un email</mat-error>
              }
              @if (oUsuarioForm?.get('email')?.hasError('email')) {
                <mat-error>Debes introducir un email correcto</mat-error>
              }
            </mat-form-field>
          </div>

          <!-- Télefono -->
          <div class="mb-3">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Télefono</mat-label>
              <input matInput formControlName="telefono" required />
              
              @if (oUsuarioForm?.get('telefono')?.hasError('required')) {
                <mat-error>El campo teléfono es obligatorio</mat-error>
              }
              @if (oUsuarioForm?.get('telefono')?.hasError('maxlength')) {
                <mat-error>El teléfono debe tener 9 dígitos</mat-error>
              }
            </mat-form-field>
          </div>

          <!-- Provincia -->
          <div class="mb-3">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Provincia</mat-label>
              <input matInput formControlName="provincia" required />
              
              @if (oUsuarioForm?.get('provincia')?.hasError('required')) {
                <mat-error>El campo provincia es obligatorio</mat-error>
              }
            </mat-form-field>
          </div>
          <!-- Código Postal -->
          <div class="mb-3">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Código Postal</mat-label>
              <input matInput formControlName="codigo_postal" required />
              <mat-hint align="start">De 3 a 5 caracteres</mat-hint>
              @if (oUsuarioForm?.get('codigo_postal')?.hasError('required')) {
                <mat-error>El campo código postal es obligatorio</mat-error>
              }
              @if (oUsuarioForm?.get('codigo_postal')?.hasError('maxlength')) {
                <mat-error>El código postal debe tener 5 dígitos</mat-error>
              }
            </mat-form-field>
          </div>
          <!-- direccion -->         
          <div class="mb-3">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Dirección</mat-label>
              <input matInput formControlName="direccion" />
            </mat-form-field>
          </div>
          <!-- DNI -->
          <div class="mb-3">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>DNI</mat-label>
              <input matInput formControlName="dni" required />
              <mat-hint align="start">De 3 a 9 caracteres</mat-hint>
              @if (oUsuarioForm?.get('dni')?.hasError('required')) {
                <mat-error>El campo DNI es obligatorio</mat-error>
              }
              @if (oUsuarioForm?.get('dni')?.hasError('maxlength')) {
                <mat-error>El DNI debe tener 9 dígitos</mat-error>
              }
            </mat-form-field>
          </div>
          <!-- Fecha Nacimiento -->
          <div class="mb-3">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Fecha Nacimiento</mat-label>
              <input matInput formControlName="fecha_nacimiento" [matDatepicker]="picker" required />
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
          </div>
          <!-- Password -->
          <div class="mb-3">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Password</mat-label>
              <input matInput formControlName="password" type="password" required />
            </mat-form-field>
          </div>
  
          <!-- Tipo de Usuario -->
          <div formGroupName="tipousuario" class="mb-4">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Tipo de Usuario</mat-label>
              <div class="d-flex justify-content-end">
                <button class="btn btn-primary" (click)="showTipoUsuarioSelectorModal()">
                  <i class="bi bi-search"></i>
                  Buscar
                </button>
              </div>
              <div class="d-flex justify-content-start">
                {{ oTipoUsuario.titulo }}
              </div>
              <input matInput formControlName="id" />
            </mat-form-field>
          </div>
  
          <!-- Botones de acción -->
          <div class="d-flex justify-content-between mt-4">
            <button class="btn btn-warning" [routerLink]="['/admin', 'usuario', 'plist']">
              <i class="bi bi-list"></i>
              Ir a listado de Usuarios
            </button>
            <button class="btn btn-secondary" (click)="onReset()">
              <i class="bi bi-x-lg"></i>
              Reset
            </button>
            <button class="btn btn-primary" type="submit" [disabled]="!oUsuarioForm?.valid">
              <i class="bi bi-floppy"></i>
              Guardar
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Modal -->
  <div class="modal fade" [id]="'mimodal'" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">GIMNASIO</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="hideModal()"></button>
        </div>
        <div class="modal-body">
          <p>{{ strMessage }}</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" (click)="hideModal()">
            Cerrar
          </button>
        </div>
      </div>
    </div>
  </div>